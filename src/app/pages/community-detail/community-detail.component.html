<div class="community-detail-container" *ngIf="!loading && community">
  <!-- Success Alert -->
  <div class="alert-success" *ngIf="success">
    <span class="alert-icon">✅</span>
    <span>{{ success }}</span>
  </div>

  <!-- Error Alert -->
  <div class="alert-error" *ngIf="error">
    <span class="alert-icon">⚠️</span>
    <span>{{ error }}</span>
  </div>

  <!-- Hero Header -->
  <div class="hero-header">
    <div class="hero-background"></div>
    <div class="hero-content">
      <div class="community-icon">🏘️</div>
      <div class="header-info">
        <h1 class="community-name">{{ community.name }}</h1>
        <div class="community-meta">
          <span class="location">
            <span class="location-icon">📍</span>
            {{ community.city
            }}{{ community.region ? ", " + community.region : "" }}
          </span>
          <span
            class="visibility-badge"
            [class.public]="community.visibility === 'public'"
          >
            <span class="badge-icon">{{
              community.visibility === "public" ? "🌍" : "🔒"
            }}</span>
            {{ community.visibility || "public" }}
          </span>
        </div>
      </div>
      <button
        class="join-btn"
        *ngIf="!isMember"
        (click)="joinCommunity()"
        [disabled]="joining"
      >
        <span class="btn-content" *ngIf="!joining">
          <span class="btn-icon">✨</span>
          <span>Join Community</span>
        </span>
        <span class="btn-loading" *ngIf="joining">
          <span class="spinner"></span>
          Joining...
        </span>
      </button>
      <button
        class="leave-btn"
        *ngIf="isMember"
        (click)="leaveCommunity()"
        [disabled]="joining"
      >
        <span class="btn-content" *ngIf="!joining">
          <span class="btn-icon">👋</span>
          <span>Leave Community</span>
        </span>
        <span class="btn-loading" *ngIf="joining">
          <span class="spinner"></span>
          Leaving...
        </span>
      </button>
    </div>
  </div>

  <!-- Content Grid -->
  <div class="content-grid">
    <!-- Main Content -->
    <div class="main-content">
      <!-- About Section -->
      <div class="content-card">
        <div class="card-header">
          <span class="card-icon">📖</span>
          <h2>About</h2>
        </div>
        <p class="about-text">
          {{
            community.description ||
              "No description available for this community."
          }}
        </p>
      </div>

      <!-- Upcoming Events Section -->
      <div class="content-card">
        <div class="card-header">
          <span class="card-icon">📅</span>
          <h2>Upcoming Events</h2>
        </div>
        <div class="event-grid" *ngIf="events.length > 0">
          <div
            class="event-card"
            *ngFor="let event of events; let i = index"
            [style.animation-delay.s]="i * 0.1"
          >
            <div class="event-icon">🎉</div>
            <div class="event-details">
              <h3 class="event-title">{{ event.title }}</h3>
              <p class="event-date">
                <span class="date-icon">🕒</span>
                {{ event.date }}
              </p>
            </div>
            <div class="event-attendees">
              <span class="attendee-icon">👥</span>
              <span class="attendee-count">{{ event.attendees }}</span>
              <span class="attendee-label">attendees</span>
            </div>
          </div>
        </div>
        <div class="empty-state" *ngIf="events.length === 0">
          <div class="empty-icon">📭</div>
          <p class="empty-text">No upcoming events scheduled.</p>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar-content">
      <!-- Members Section -->
      <div class="content-card">
        <div class="card-header">
          <span class="card-icon">👥</span>
          <h2>Members ({{ members.length }})</h2>
        </div>
        <div class="member-grid">
          <div
            class="member-card"
            *ngFor="let member of members; let i = index"
            [style.animation-delay.s]="i * 0.05"
          >
            <div class="member-avatar">
              {{ member.fullName.charAt(0) }}
            </div>
            <div class="member-details">
              <h4 class="member-name">{{ member.fullName }}</h4>
              <p class="member-role">{{ member.role }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Community Stats Section -->
      <div class="content-card stats-card">
        <div class="card-header">
          <span class="card-icon">📊</span>
          <h2>Community Stats</h2>
        </div>
        <div class="stats-grid">
          <div class="stat-box">
            <div class="stat-icon">👥</div>
            <div class="stat-details">
              <span class="stat-value">{{ members.length }}</span>
              <span class="stat-label">Members</span>
            </div>
          </div>
          <div class="stat-box">
            <div class="stat-icon">📅</div>
            <div class="stat-details">
              <span class="stat-value">{{ events.length }}</span>
              <span class="stat-label">Events</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Loading State -->
<div class="loading-state" *ngIf="loading">
  <div class="spinner-wrapper">
    <div class="spinner-large"></div>
    <p class="loading-text">Loading community details...</p>
  </div>
</div>
